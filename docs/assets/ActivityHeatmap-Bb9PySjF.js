var E=(a,r,d)=>new Promise((n,m)=>{var p=s=>{try{i(d.next(s))}catch(o){m(o)}},x=s=>{try{i(d.throw(s))}catch(o){m(o)}},i=s=>s.done?n(s.value):Promise.resolve(s.value).then(p,x);i((d=d.apply(a,r)).next())});import{r as l,j as e}from"./ui-vendor-nuurtrVt.js";import{B as N}from"./badge-CktKq16L.js";import{c as $,m as I,Z as S,U as O,j as G,s as F,T as J,B as j,L as K,v as Y}from"./index-Dp-8Rdet.js";import{M as C}from"./map-pin-dgmPVUiH.js";import{A as q}from"./index-DPOCzKQs.js";import{MapView as Q}from"./MapView-tuUUwDzD.js";import{F as X}from"./funnel-DFW9sI9U.js";import{M as ee,T as te,C as ae,a as se}from"./map-vendor-Dx__-sQZ.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],le=$("map",re);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]],ne=$("radio",ie);function Se({category:a="all"}){const[r,d]=l.useState([{id:"1",type:"match",title:"Football Match in Progress",location:"Sky Sports Arena",participants:10,distance:"0.8 km",startedAt:"15 min ago",category:"sports"},{id:"2",type:"event",title:"Poetry Slam Session",location:"Culture Hub",participants:24,distance:"1.2 km",startedAt:"5 min ago",category:"events"},{id:"3",type:"party",title:"Rooftop DJ Night",location:"Skybar Lounge",participants:45,distance:"2.1 km",startedAt:"30 min ago",category:"parties"},{id:"4",type:"match",title:"Cricket Practice Session",location:"Green Fields",participants:8,distance:"1.5 km",startedAt:"10 min ago",category:"sports"}]),[n,m]=l.useState(null),p=a==="all"?r:r.filter(s=>s.category===a);l.useEffect(()=>{const s=setInterval(()=>{const o=[{id:Date.now().toString(),type:"match",title:"Badminton Match Starting",location:"Indoor Arena",participants:4,distance:"0.5 km",startedAt:"just now",category:"sports"},{id:Date.now().toString(),type:"event",title:"Art Gallery Opening",location:"Modern Art Space",participants:18,distance:"1.8 km",startedAt:"just now",category:"events"}],h=o[Math.floor(Math.random()*o.length)];m(h),setTimeout(()=>{d(b=>[h,...b].slice(0,3)),m(null)},3e3)},15e3);return()=>clearInterval(s)},[]);const x=s=>{switch(s){case"match":return"bg-cyan-50 text-cyan-700";case"event":return"bg-indigo-50 text-indigo-700";case"party":return"bg-amber-50 text-amber-700";default:return"bg-slate-100 text-slate-700"}},i=s=>{switch(s){case"match":return"âš½";case"event":return"ðŸŽ¨";case"party":return"ðŸŽ‰";default:return"ðŸ“"}};return e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"What's Happening Now?"})]}),e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"}),"Live updates"]})]}),e.jsx(q,{children:n&&e.jsx(I.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.95},className:"mb-4",children:e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm dark:bg-slate-900 dark:border-slate-800",children:e.jsxs("div",{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 rounded-lg bg-amber-100 text-amber-700",children:e.jsx(S,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"New activity started"}),e.jsx("h3",{className:"mb-1 text-base font-semibold text-slate-900 dark:text-slate-100",children:n.title}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-600 dark:text-slate-300",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),n.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"w-3 h-3"}),n.participants]})]})]})]})})})}),e.jsx("div",{className:"space-y-3",children:p.slice(0,3).map((s,o)=>e.jsx(I.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:o*.1},children:e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm dark:bg-slate-900 dark:border-slate-800",children:e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl flex-shrink-0 ${x(s.type)}`,children:i(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"mb-1 text-base font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-600 dark:text-slate-300",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),s.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"w-3 h-3"}),s.participants]}),e.jsxs("span",{className:"text-indigo-600 dark:text-indigo-400",children:[s.distance," away"]})]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsxs(N,{className:"bg-slate-100 text-slate-800 border border-slate-200 dark:bg-slate-800 dark:text-slate-200 dark:border-slate-700",children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),s.startedAt]})})]})})},s.id))})]})}const ce=ee,de=te,B=ae,D=se,H={lat:23.0225,lng:72.5714},P={"sabarmati ashram":{lat:23.0596,lng:72.5771},"kankaria lake":{lat:22.9988,lng:72.6189},"law garden":{lat:23.0295,lng:72.5556},"sardar patel stadium":{lat:23.0878,lng:72.5703},"cept university":{lat:23.0295,lng:72.5556},"gujarat university sports complex":{lat:23.0685,lng:72.5348},"gujarat university":{lat:23.0685,lng:72.5348},"vastrapur lake":{lat:23.0381,lng:72.5253},"sg highway":{lat:23.033,lng:72.5174},"city sports arena":{lat:23.0708,lng:72.5367},"sky sports arena":{lat:23.0708,lng:72.5367}},w=[{id:"fallback-1",name:"Sky Sports Arena",category:"sports",activeNow:28,lat:23.0225,lng:72.5714,intensity:"high",location:"Sky Sports Arena"},{id:"fallback-2",name:"Culture Hub",category:"cultural",activeNow:22,lat:23.0335,lng:72.585,intensity:"medium",location:"Culture Hub"},{id:"fallback-3",name:"Skybar Lounge",category:"parties",activeNow:41,lat:23.0195,lng:72.568,intensity:"high",location:"Skybar Lounge"}],oe=a=>{if(a!=="all")return a==="cultural"||a==="events"?"events":a},me=a=>a==="events"?"cultural":a==="sports"?"sports":a==="parties"?"parties":"sports",xe=a=>a>=35?"high":a>=15?"medium":"low",pe=a=>{switch(a){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-amber-100 text-amber-700 border-amber-200";default:return"bg-emerald-100 text-emerald-700 border-emerald-200"}},ue=a=>{switch(a){case"sports":return"bg-cyan-50 text-cyan-700";case"cultural":return"bg-indigo-50 text-indigo-700";case"parties":return"bg-amber-50 text-amber-700"}},z=a=>{switch(a){case"sports":return"âš½";case"cultural":return"ðŸŽ¨";case"parties":return"ðŸŽ‰"}},ge=a=>{if(a!=null&&a.lat&&(a!=null&&a.lng))return{lat:a.lat,lng:a.lng};const r=((a==null?void 0:a.location)||(a==null?void 0:a.turf_name)||"").toLowerCase();return r&&P[r]?P[r]:null},R=a=>{var p,x,i;const r=ge(a);if(!r)return null;const d=a,n=(i=(x=(p=d.current_players)!=null?p:d.max_players)!=null?x:d.min_players)!=null?i:12,m=me(a.category);return{id:a.id,name:a.title||a.turf_name||"Live event",category:m,activeNow:n,lat:r.lat,lng:r.lng,intensity:xe(n),location:a.location||a.turf_name,datetime:a.date&&a.time?`${a.date} ${a.time}`:void 0,maxParticipants:a.max_players,hostId:a.user_id}};function Ce({category:a="all"}){var T;const[r,d]=l.useState(a!=null?a:"all"),[n,m]=l.useState("map"),[p,x]=l.useState(!1),[i,s]=l.useState(w),[o,h]=l.useState(!1),[b,f]=l.useState(!1),[v,A]=l.useState(H),[M,L]=l.useState(null);l.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{A({lat:t.coords.latitude,lng:t.coords.longitude})},()=>{A(H)})},[]),l.useEffect(()=>{let t=!1;return E(null,null,function*(){h(!0);try{const u=yield Y.getMatches();if(t)return;const g=u.map(R).filter(Boolean);g.length>0?(s(g),f(!0)):(f(!1),s(w)),L(new Date().toISOString())}catch(u){console.error("Failed to load live heatmap matches from Supabase",u),t||(f(!1),s(w))}finally{t||h(!1)}}),()=>{t=!0}},[]),l.useEffect(()=>{const t=F.channel("matches-heatmap").on("postgres_changes",{event:"*",schema:"public",table:"matches"},c=>{f(!0),s(u=>{var _;if(c.eventType==="DELETE"&&((_=c.old)!=null&&_.id))return u.filter(k=>k.id!==c.old.id);const g=R(c.new);if(!g)return u;const Z=u.filter(k=>k.id!==g.id);return[g,...Z]}),L(new Date().toISOString())}).subscribe();return()=>{F.removeChannel(t)}},[]);const y=l.useMemo(()=>{if(r==="all")return i;const t=r==="events"?"cultural":r;return i.filter(c=>c.category===t)},[i,r]),U=y.reduce((t,c)=>t+c.activeNow,0),V=t=>t==="cultural"?"events":t==="parties"?"parties":"sports",W=l.useMemo(()=>i.map(t=>({id:t.id,title:t.name,category:V(t.category),type:t.category,location:t.location||t.name,lat:t.lat,lng:t.lng,datetime:t.datetime,participants:t.activeNow,maxParticipants:t.maxParticipants,creator:t.hostId})),[i]);return e.jsxs("div",{className:"mb-8 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-indigo-500"}),e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Activity Heatmap"}),e.jsxs(N,{className:"border border-indigo-200 text-indigo-700 bg-indigo-50 dark:bg-indigo-500/10 dark:text-indigo-100 dark:border-indigo-400/60",children:[U," people active nearby"]}),b&&M&&e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Live â€¢ updated ",new Date(M).toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:n==="list"?"default":"outline",size:"sm",onClick:()=>m("list"),className:"rounded-full px-4",children:"List"}),e.jsx(j,{variant:n==="map"?"default":"outline",size:"sm",onClick:()=>m("map"),className:"rounded-full px-4",children:"Map"})]})]}),e.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:["all","sports","cultural","parties"].map(t=>e.jsxs(j,{variant:r===t?"default":"outline",size:"sm",onClick:()=>d(t),className:`capitalize whitespace-nowrap rounded-full px-4 ${r===t?"bg-indigo-600 text-white hover:bg-indigo-600":"border-slate-200 text-slate-700 dark:text-slate-200"}`,children:[e.jsx(X,{className:"w-3 h-3 mr-1"}),t]},t))}),n==="map"?e.jsxs("div",{className:"relative h-96 rounded-xl overflow-hidden border border-slate-200 bg-white shadow-md dark:bg-slate-900 dark:border-slate-800",children:[e.jsxs(ce,{center:[v.lat,v.lng],zoom:13,className:"h-full w-full",scrollWheelZoom:!0,children:[e.jsx(de,{attribution:"Â© OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(B,{center:[v.lat,v.lng],radius:10,pathOptions:{color:"#06b6d4",fillColor:"#22d3ee",fillOpacity:.4},children:e.jsx(D,{direction:"top",offset:[0,-6],opacity:1,permanent:!0,children:e.jsx("div",{className:"text-xs font-medium text-cyan-800",children:"You"})})}),y.map(t=>e.jsx(B,{center:[t.lat,t.lng],radius:t.intensity==="high"?18:t.intensity==="medium"?14:10,pathOptions:{color:t.intensity==="high"?"#f97316":t.intensity==="medium"?"#fbbf24":"#34d399",fillColor:"#ffffff",fillOpacity:.15,weight:3},children:e.jsx(D,{direction:"top",offset:[0,-2],opacity:1,sticky:!0,children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:z(t.category)}),e.jsx("span",{className:"font-semibold",children:t.name})]}),e.jsxs("p",{className:"text-xs text-slate-600",children:[t.activeNow," people active"]}),t.location&&e.jsx("p",{className:"text-xs text-slate-500",children:t.location}),t.datetime&&e.jsx("p",{className:"text-xs text-slate-500",children:t.datetime})]})})},t.id))]}),o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/70 dark:bg-slate-900/70 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-200",children:[e.jsx(K,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Syncing live mapâ€¦"})]})}),!b&&!o&&e.jsx("div",{className:"absolute bottom-4 left-4 bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm rounded-lg px-3 py-2 text-xs text-slate-600 dark:text-slate-300",children:"Showing sample hotspots while Supabase data loads."}),e.jsxs("div",{className:"absolute bottom-4 right-4 bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm rounded-lg px-3 py-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx(C,{className:"w-3 h-3 inline mr-1"}),"Live nearby map"]})]}):e.jsx("div",{className:"space-y-3",children:y.slice().sort((t,c)=>c.activeNow-t.activeNow).map((t,c)=>e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm dark:bg-slate-900 dark:border-slate-800",children:e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center text-2xl border ${pe(t.intensity)}`,children:z(t.category)}),t.intensity==="high"&&e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(S,{className:"w-5 h-5 text-amber-500 animate-pulse"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900 dark:text-slate-100",children:t.name}),e.jsx(N,{className:`${ue(t.category)} border border-slate-200 dark:border-slate-700`,children:t.category})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-600 dark:text-slate-300",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3 text-indigo-500"}),t.activeNow," active now"]}),e.jsxs(N,{variant:"outline",className:`capitalize border ${t.intensity==="high"?"border-red-200 text-red-700 bg-red-50 dark:bg-red-500/10 dark:border-red-500/40":t.intensity==="medium"?"border-amber-200 text-amber-700 bg-amber-50 dark:bg-amber-500/10 dark:border-amber-500/40":"border-emerald-200 text-emerald-700 bg-emerald-50 dark:bg-emerald-500/10 dark:border-emerald-500/40"}`,children:[t.intensity," activity"]})]}),t.location&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:t.location})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-semibold text-slate-900 dark:text-slate-100",children:["#",c+1]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Rank"})]})]})},t.id))}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm dark:bg-slate-900 dark:border-slate-800",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Activity Intensity"}),e.jsxs(j,{size:"sm",onClick:()=>x(!0),className:"gap-2 rounded-full px-4 bg-indigo-600 hover:bg-indigo-700 text-white",children:[e.jsx(le,{className:"w-4 h-4"}),"View Full Map"]})]}),e.jsxs("div",{className:"flex gap-4 text-sm text-slate-700 dark:text-slate-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{children:"High (35+ people)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500"}),e.jsx("span",{children:"Medium (15-34 people)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500"}),e.jsx("span",{children:"Low (<15 people)"})]})]})]})})}),p&&e.jsx(Q,{onClose:()=>x(!1),category:(T=oe(r))!=null?T:"all",events:W})]})}export{Ce as A,Se as L};
